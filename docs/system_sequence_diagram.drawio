<mxfile host="65bd71144e">
    <diagram id="hEeOqorTtUtQZ6ahrq-n" name="Page-1">
        <mxGraphModel dx="2309" dy="778" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="319" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;MbedTLS&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="670" y="31" width="150" height="1979" as="geometry"/>
                </mxCell>
                <mxCell id="320" value="&lt;b&gt;HSECREST&lt;/b&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;fontSize=12;" parent="319" target="345" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="79" y="430" as="sourcePoint"/>
                        <mxPoint x="-1" y="430" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="321" value="&lt;b&gt;clientRSA&lt;/b&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;fontSize=12;" parent="319" target="345" edge="1">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="74" y="529" as="sourcePoint"/>
                        <mxPoint x="-6" y="529" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="322" value="&lt;b&gt;Security seq&lt;br&gt;diagram&lt;br&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;" parent="319" vertex="1">
                    <mxGeometry x="15" y="560" width="120" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="323" value="&lt;b&gt;EXAMPLE&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;" parent="319" vertex="1">
                    <mxGeometry x="10" y="70" width="120" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="324" value="22 Send authenticiation token + AES + hmac&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;br&gt;eeeeen&lt;br&gt;&lt;/span&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontStyle=1;" parent="319" source="345" edge="1">
                    <mxGeometry x="-0.0513" y="10" width="160" relative="1" as="geometry">
                        <mxPoint x="-163.25" y="1649" as="sourcePoint"/>
                        <mxPoint x="337.26" y="1649" as="targetPoint"/>
                        <mxPoint x="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="325" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;Communication&lt;br&gt;&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="930" y="30" width="150" height="1960" as="geometry"/>
                </mxCell>
                <mxCell id="326" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Establish connection&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="325" target="325" edge="1">
                    <mxGeometry x="0.0269" y="10" width="80" relative="1" as="geometry">
                        <mxPoint x="-425" y="231" as="sourcePoint"/>
                        <mxPoint x="70" y="231" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="327" value="&lt;b&gt;13 Session established&lt;br&gt;Send&amp;nbsp; Encrypt session key + HMAC&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontSize=12;" parent="325" edge="1">
                    <mxGeometry x="0.0243" y="6" width="160" relative="1" as="geometry">
                        <mxPoint x="80" y="1130" as="sourcePoint"/>
                        <mxPoint x="316.74999999999955" y="1130" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="328" value="23 Send authenticiation token+ AES + hmac&amp;nbsp;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%333332FmxGrannnphModel%3E&lt;/span&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontStyle=1;" parent="325" edge="1">
                    <mxGeometry x="-0.0585" y="10" width="160" relative="1" as="geometry">
                        <mxPoint x="80" y="1680" as="sourcePoint"/>
                        <mxPoint x="319.5100000000002" y="1680" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="329" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;Communication&lt;br&gt;&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1173" y="30" width="150" height="1980" as="geometry"/>
                </mxCell>
                <mxCell id="330" value="&lt;b style=&quot;border-color: var(--border-color); color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;8 Send public key + hmac&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="329" edge="1">
                    <mxGeometry x="0.0332" y="15" width="100" relative="1" as="geometry">
                        <mxPoint x="-173" y="911" as="sourcePoint"/>
                        <mxPoint x="77" y="910" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="-48" y="910"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="331" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;MbedTLS&lt;br&gt;&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1427" y="32" width="150" height="1978" as="geometry"/>
                </mxCell>
                <mxCell id="332" value="&lt;b&gt;6 Generate server key pair and &lt;br&gt;send server public key + hmac&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontSize=12;" parent="331" edge="1">
                    <mxGeometry x="-0.0448" y="8" width="160" relative="1" as="geometry">
                        <mxPoint x="-179.67647058823513" y="786.0020000000002" as="sourcePoint"/>
                        <mxPoint x="307.49999999999955" y="786.0020000000002" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="333" value="&lt;b&gt;15 Server sends encrypted confiramtion + HMAC&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="331" target="339" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="-179" y="1288" as="sourcePoint"/>
                        <mxPoint x="288.5" y="1288.0593294137093" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="153" y="1288"/>
                            <mxPoint x="153" y="1288"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="334" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;Application&lt;br&gt;&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1899" y="30" width="150" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="335" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Communication created&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;" parent="1" target="345" edge="1">
                    <mxGeometry x="-0.0281" y="-7" relative="1" as="geometry">
                        <mxPoint x="1000.0000000000005" y="210" as="sourcePoint"/>
                        <mxPoint x="500.25" y="207" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="660" y="207"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="336" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Connected&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;" parent="1" source="325" target="345" edge="1">
                    <mxGeometry x="0.0369" y="-8" relative="1" as="geometry">
                        <mxPoint x="1217" y="358" as="sourcePoint"/>
                        <mxPoint x="496.75" y="358" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="665.19" y="358"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="337" value="" style="shape=umlLifeline;participant=umlActor;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;verticalAlign=top;spacingTop=36;outlineConnect=0;size=50;" parent="1" vertex="1">
                    <mxGeometry x="-37" y="32" width="30" height="3638" as="geometry"/>
                </mxCell>
                <mxCell id="410" value="" style="html=1;points=[];perimeter=orthogonalPerimeter;" vertex="1" parent="337">
                    <mxGeometry x="20" y="2154" width="10" height="336" as="geometry"/>
                </mxCell>
                <mxCell id="338" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Create connection&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" edge="1">
                    <mxGeometry x="-0.0066" y="8" width="80" relative="1" as="geometry">
                        <mxPoint x="497.82352941176487" y="167" as="sourcePoint"/>
                        <mxPoint x="1004.5" y="167" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="339" value="&lt;span style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;Session&lt;br&gt;&lt;/span&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1660" y="29" width="150" height="1971" as="geometry"/>
                </mxCell>
                <mxCell id="340" value="&lt;b style=&quot;border-color: var(--border-color); background-color: rgb(251, 251, 251);&quot;&gt;7 server generates a temporary RSA key pair.&lt;br&gt;&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="339" edge="1">
                    <mxGeometry x="-0.5858" y="15" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="79.99999999999982" y="824.0359999999998" as="sourcePoint"/>
                        <mxPoint x="80.87352941176486" y="857" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="80.55" y="821"/>
                            <mxPoint x="157.55" y="821"/>
                            <mxPoint x="157.55" y="857"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="341" value="&lt;b&gt;17 Server decrypts request and validates HMAC&lt;br&gt;decrypt the cyper&lt;br&gt;&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="339" edge="1">
                    <mxGeometry x="-0.5905" y="15" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="71.44999999999982" y="1223.036" as="sourcePoint"/>
                        <mxPoint x="72.32352941176487" y="1256" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="72" y="1220"/>
                            <mxPoint x="149" y="1220"/>
                            <mxPoint x="149" y="1256"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="342" value="24 Send authenticiation&amp;nbsp; token+ AES + hmac&amp;nbsp;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; font-weight: 400; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%33333442FmxGraphModel%3E&lt;/span&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontStyle=1;" parent="339" source="329" edge="1">
                    <mxGeometry x="-0.0513" y="10" width="160" relative="1" as="geometry">
                        <mxPoint x="-160" y="1721" as="sourcePoint"/>
                        <mxPoint x="79.51000000000022" y="1721" as="targetPoint"/>
                        <mxPoint x="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="343" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Connection failed&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;" parent="1" target="345" edge="1">
                    <mxGeometry x="-0.0038" y="-8" relative="1" as="geometry">
                        <mxPoint x="1000.0000000000005" y="308" as="sourcePoint"/>
                        <mxPoint x="520" y="310" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="761.19" y="308"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="344" value="" style="text;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;spacingTop=-1;spacingLeft=4;spacingRight=4;rotatable=0;labelPosition=right;points=[];portConstraint=eastwest;" parent="1" vertex="1">
                    <mxGeometry x="1790" y="90" width="20" height="14" as="geometry"/>
                </mxCell>
                <mxCell id="345" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;Session&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="423" y="30" width="151" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="346" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Create Session&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="345" source="353" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="-117" y="116.47779273216689" as="sourcePoint"/>
                        <mxPoint x="77.5" y="116.47779273216689" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="347" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Terminate Client&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;" parent="345" target="353" edge="1">
                    <mxGeometry x="-0.04" y="-10" relative="1" as="geometry">
                        <mxPoint x="74.68" y="359.9988649618663" as="sourcePoint"/>
                        <mxPoint x="-197.99647058823513" y="359.9988649618663" as="targetPoint"/>
                        <Array as="points"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="348" value="&lt;b&gt;19 Client Decrypts Response and Validates HMAC&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="345" edge="1">
                    <mxGeometry x="-0.3113" y="8" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="72.44999999999987" y="1441.036" as="sourcePoint"/>
                        <mxPoint x="73.32352941176492" y="1474" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="73.00000000000006" y="1438"/>
                            <mxPoint x="150.00000000000006" y="1438"/>
                            <mxPoint x="150.00000000000006" y="1474"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="349" value="&lt;b&gt;20 Client decrypts response and validates HMAC&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="345" edge="1">
                    <mxGeometry x="-0.569" y="11" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="73.44999999999987" y="1502.036" as="sourcePoint"/>
                        <mxPoint x="74.32352941176492" y="1535" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="74.00000000000006" y="1499"/>
                            <mxPoint x="151.00000000000006" y="1499"/>
                            <mxPoint x="151.00000000000006" y="1535"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="350" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;SHA256(SECREST&lt;/b&gt;&lt;/font&gt;)" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;" parent="345" target="319" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="77" y="390" as="sourcePoint"/>
                        <mxPoint x="327" y="390" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="351" value="&lt;b&gt;Generate clientRSA&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;" parent="345" edge="1">
                    <mxGeometry x="-0.0607" y="2" width="160" relative="1" as="geometry">
                        <mxPoint x="77" y="482" as="sourcePoint"/>
                        <mxPoint x="332.5" y="482" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="352" value="&lt;b&gt;11 client generate temp RSA key pair&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="345" edge="1">
                    <mxGeometry x="-0.569" y="11" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="73.44999999999982" y="1013.0360000000001" as="sourcePoint"/>
                        <mxPoint x="74.32352941176487" y="1046" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="74.00000000000006" y="1010"/>
                            <mxPoint x="151" y="1010"/>
                            <mxPoint x="151" y="1046"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="353" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;User interface&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="158" y="25" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="354" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Start&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="353" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="-178" y="90" as="sourcePoint"/>
                        <mxPoint x="78.5" y="90.00000000000023" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="355" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Terminated&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;endArrow=open;dashed=1;endSize=8;" parent="353" edge="1" target="337">
                    <mxGeometry relative="1" as="geometry">
                        <mxPoint x="74.18" y="400" as="sourcePoint"/>
                        <mxPoint x="-168" y="400" as="targetPoint"/>
                        <Array as="points"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="356" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;1 Start&lt;/b&gt;&lt;/span&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="353" source="337" edge="1">
                    <mxGeometry width="80" relative="1" as="geometry">
                        <mxPoint x="-168.99647058823513" y="616.0000000000002" as="sourcePoint"/>
                        <mxPoint x="84.18" y="616.0000000000002" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="357" value="&lt;b&gt;9 Validate confiramtion + HMAC&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=open;startFill=0;strokeColor=#545B64;rounded=0;fontSize=12;dashed=1;" parent="1" edge="1">
                    <mxGeometry y="19" width="100" relative="1" as="geometry">
                        <mxPoint x="746" y="969" as="sourcePoint"/>
                        <mxPoint x="1005.2499999999991" y="968" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="843.75" y="968"/>
                            <mxPoint x="843.75" y="968"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="358" value="&lt;b style=&quot;border-color: var(--border-color); background-color: rgb(251, 251, 251);&quot;&gt;10 Generate client key pair and&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;send server public key + hmac&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" target="325" edge="1">
                    <mxGeometry x="0.2289" y="11" width="100" relative="1" as="geometry">
                        <mxPoint x="500.0035294117647" y="1011.3800000000001" as="sourcePoint"/>
                        <mxPoint x="980" y="1007" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="930" y="1011"/>
                            <mxPoint x="930" y="1011"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="359" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;2 create serial port&lt;/b&gt;&lt;/span&gt;" style="html=1;verticalAlign=bottom;endArrow=block;" parent="1" edge="1">
                    <mxGeometry x="0.0041" width="80" relative="1" as="geometry">
                        <mxPoint x="237.96153846153857" y="672.4777927321666" as="sourcePoint"/>
                        <mxPoint x="501.5" y="672.4777927321666" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="360" value="&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;blockquote style=&quot;margin: 0 0 0 40px; border: none; padding: 0px;&quot;&gt;&lt;font style=&quot;font-size: 12px;&quot;&gt;3 Client generates a temporary RSA key pair. + hmac&lt;/font&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;/blockquote&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontStyle=1;" parent="1" target="325" edge="1">
                    <mxGeometry x="-0.0039" y="2" width="160" relative="1" as="geometry">
                        <mxPoint x="497.46153846153857" y="711.9999999999995" as="sourcePoint"/>
                        <mxPoint x="740" y="712" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="361" value="&lt;b&gt;4 Send public key + HMAC.&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;" parent="1" source="325" edge="1">
                    <mxGeometry x="-0.0089" y="10" width="160" relative="1" as="geometry">
                        <mxPoint x="740" y="740" as="sourcePoint"/>
                        <mxPoint x="1244.5" y="740.0000000000002" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="362" value="&lt;b&gt;5 Validate HMAC&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;dashed=1;" parent="1" edge="1">
                    <mxGeometry x="-0.0408" y="12" width="160" relative="1" as="geometry">
                        <mxPoint x="1250" y="773.0900000000001" as="sourcePoint"/>
                        <mxPoint x="1500.5" y="770" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="363" value="&lt;b style=&quot;border-color: var(--border-color); color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;8 Send server public key + hmac&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" edge="1">
                    <mxGeometry x="0.0332" y="15" width="100" relative="1" as="geometry">
                        <mxPoint x="1250" y="909" as="sourcePoint"/>
                        <mxPoint x="1732" y="909" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1375" y="908"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="364" value="&lt;b&gt;12 Encrypt session key + HMAC&lt;br&gt;create cypher&lt;br&gt;&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontSize=12;" parent="1" source="345" edge="1">
                    <mxGeometry x="-0.0046" y="9" width="160" relative="1" as="geometry">
                        <mxPoint x="540" y="1109" as="sourcePoint"/>
                        <mxPoint x="1004.4999999999995" y="1109" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="365" value="&lt;b&gt;15 Send&amp;nbsp; Encrypt session key + HMAC&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=block;endFill=1;fontSize=12;" parent="1" edge="1">
                    <mxGeometry x="0.0266" y="6" width="160" relative="1" as="geometry">
                        <mxPoint x="1247.25" y="1222" as="sourcePoint"/>
                        <mxPoint x="1736.75" y="1222" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="366" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;14 Validate session key + HMAC&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;dashed=1;" parent="1" edge="1">
                    <mxGeometry x="-0.0523" y="11" width="160" relative="1" as="geometry">
                        <mxPoint x="1253" y="1181" as="sourcePoint"/>
                        <mxPoint x="1500" y="1180" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="367" value="&lt;b&gt;17 Server sends encrypted confiramtion + HMAC&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" target="329" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="1004.7500000000005" y="1385" as="sourcePoint"/>
                        <mxPoint x="1491.25" y="1385" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1160" y="1385"/>
                            <mxPoint x="1160" y="1385"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="368" value="&lt;b&gt;18 Client recives encrypted confiramtion + HMAC&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="497.75" y="1420" as="sourcePoint"/>
                        <mxPoint x="1002.75" y="1420" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="660" y="1420"/>
                            <mxPoint x="660" y="1420"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="369" value="&lt;b&gt;21 Client authentication&lt;/b&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" edge="1">
                    <mxGeometry x="-0.573" y="11" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500.4499999999998" y="1608.036" as="sourcePoint"/>
                        <mxPoint x="501.32352941176487" y="1641" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="501.00000000000006" y="1605"/>
                            <mxPoint x="578" y="1605"/>
                            <mxPoint x="578" y="1641"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="370" value="&lt;span style=&quot;font-size: 11px; font-weight: 700; background-color: rgb(251, 251, 251);&quot;&gt;25 Send authenticiation&amp;nbsp; token+ AES + hmac&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color); background-color: rgb(251, 251, 251); color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%2FmxGraphModel%3E&lt;/span&gt;&lt;span style=&quot;border-color: var(--border-color); background-color: rgb(251, 251, 251); color: rgba(0, 0, 0, 0); font-family: monospace; font-size: 0px; text-align: start;&quot;&gt;%3CmxGraphModel%3E%3Croot%3E%3CmxCell%20id%3D%220%22%2F%3E%3CmxCell%20id%3D%221%22%20parent%3D%220%22%2F%3E%3CmxCell%20id%3D%222%22%20value%3D%2222%20Send%20auth%22%20style%3D%22html%3D1%3BverticalAlign%3Dbottom%3BlabelBackgroundColor%3Dnone%3BendArrow%3Dblock%3BendFill%3D1%3BfontStyle%3D1%3B%22%20edge%3D%221%22%20parent%3D%221%22%3E%3CmxGeometry%20x%3D%22-0.0513%22%20y%3D%2210%22%20width%3D%22160%22%20relative%3D%221%22%20as%3D%22geometry%22%3E%3CmxPoint%20x%3D%22487.75%22%20y%3D%221670%22%20as%3D%22sourcePoint%22%2F%3E%3CmxPoint%20x%3D%22988.2600000000002%22%20y%3D%221670%22%20as%3D%22targetPoint%22%2F%3E%3CmxPoint%20x%3D%22-1%22%20as%3D%22offset%22%2F%3E%3C%2FmxGeometry%3E%3C%2FmxCell%3E%3C%2Froot%3E%3C%33333442FmxGraphModel%3E&lt;/span&gt;" style="edgeStyle=segmentEdgeStyle;endArrow=classic;html=1;curved=0;rounded=0;endSize=8;startSize=8;fontSize=12;exitX=0.523;exitY=0.848;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" edge="1">
                    <mxGeometry x="-0.5859" y="15" width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1732.4499999999998" y="1783.036" as="sourcePoint"/>
                        <mxPoint x="1733.3235294117649" y="1816" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1733" y="1780"/>
                            <mxPoint x="1810" y="1780"/>
                            <mxPoint x="1810" y="1816"/>
                        </Array>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="371" value="&lt;b&gt;26 Server sends&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 11px; font-weight: 700; background-color: rgb(251, 251, 251);&quot;&gt;authenticiation +AES+hmac&lt;/span&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="1249.5" y="1850" as="sourcePoint"/>
                        <mxPoint x="1730" y="1850" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1411.75" y="1850"/>
                            <mxPoint x="1411.75" y="1850"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="372" value="&lt;b&gt;27 send&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 11px; font-weight: 700; background-color: rgb(251, 251, 251);&quot;&gt;authenticiation +AES+hmac&lt;/span&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" target="329" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="1000.0000000000005" y="1884" as="sourcePoint"/>
                        <mxPoint x="1240" y="1884" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="1160" y="1884"/>
                            <mxPoint x="1160" y="1884"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="373" value="&lt;b&gt;28 Client recives&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;font-size: 11px; font-weight: 700; background-color: rgb(251, 251, 251);&quot;&gt;authenticiation +AES+hmac&lt;/span&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" target="325" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="500" y="1900" as="sourcePoint"/>
                        <mxPoint x="747.5" y="1900" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="870" y="1900"/>
                            <mxPoint x="870" y="1900"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="374" value="&lt;b&gt;29 Session establish&amp;nbsp;&lt;/b&gt;" style="edgeStyle=orthogonalEdgeStyle;html=1;endArrow=none;elbow=vertical;startArrow=block;startFill=1;strokeColor=#545B64;rounded=0;fontSize=12;" parent="1" source="337" edge="1">
                    <mxGeometry y="13" width="100" relative="1" as="geometry">
                        <mxPoint x="240" y="1930" as="sourcePoint"/>
                        <mxPoint x="487.5" y="1930" as="targetPoint"/>
                        <mxPoint as="offset"/>
                        <Array as="points">
                            <mxPoint x="110" y="1930"/>
                            <mxPoint x="110" y="1930"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="376" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;User interface&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="158" y="1995" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="377" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;Session&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="419.5" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="378" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;MbedTLS&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="666" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="384" value="&lt;b&gt;Led and temperature&lt;br&gt;&lt;br&gt;&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=12;" parent="378" vertex="1">
                    <mxGeometry x="19" y="100" width="120" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="379" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Client&lt;br&gt;Communication&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="930" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="380" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;communication&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1169" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="381" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;MbedTLS&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1423" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="382" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;Session&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1656" y="2002" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="391" value="&lt;b&gt;Server decrypts and validates toggle LED command.&lt;br&gt;&lt;br&gt;The server decrypts the message and verifies the HMAC&lt;/b&gt;." style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;" parent="382" source="380" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="-156.00000000000045" y="243" as="sourcePoint"/>
                        <mxPoint x="83.75" y="243" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="383" value="&lt;font style=&quot;font-size: 14px;&quot;&gt;Server&lt;br&gt;Application&lt;br&gt;&lt;/font&gt;" style="shape=umlLifeline;perimeter=lifelinePerimeter;whiteSpace=wrap;html=1;container=1;collapsible=0;recursiveResize=0;outlineConnect=0;size=62;" parent="1" vertex="1">
                    <mxGeometry x="1895" y="2000" width="158" height="1970" as="geometry"/>
                </mxCell>
                <mxCell id="390" value="&lt;b&gt;Server toggles LED&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;The server toggles the LED (GPIO operation&lt;/b&gt;).." style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;" parent="383" edge="1">
                    <mxGeometry x="0.049" width="160" relative="1" as="geometry">
                        <mxPoint x="-160.75000000000045" y="279" as="sourcePoint"/>
                        <mxPoint x="79" y="279" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="385" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Client sends toggle LED command + AES + HMAC&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;" parent="1" edge="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="500" y="2186" as="sourcePoint"/>
                        <mxPoint x="1008.5" y="2186" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="590" y="2186"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="389" value="&lt;b&gt;Server receives toggle LED command + AES + HMAC&lt;br&gt;&lt;br&gt;The server receives the encrypted command and prepares to process it.&lt;/b&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;fontSize=12;" parent="1" source="379" edge="1">
                    <mxGeometry x="0.001" width="160" relative="1" as="geometry">
                        <mxPoint x="1088" y="2220" as="sourcePoint"/>
                        <mxPoint x="1248" y="2220" as="targetPoint"/>
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="409" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;LED ON&lt;/b&gt;&lt;/font&gt;&amp;nbsp;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;dashed=1;" edge="1" parent="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="497.99999999999955" y="2516" as="sourcePoint"/>
                        <mxPoint x="-10" y="2516" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="411" value="&lt;font style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Establish&lt;/b&gt;&lt;/font&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;dashed=1;exitX=0.7;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="410" target="377">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="230" y="2188" as="sourcePoint"/>
                        <mxPoint x="390" y="2188" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="412" value="&lt;span style=&quot;font-size: 12px;&quot;&gt;&lt;b&gt;Toggle&amp;nbsp; LED&lt;/b&gt;&lt;/span&gt;" style="html=1;verticalAlign=bottom;labelBackgroundColor=none;endArrow=open;endFill=0;dashed=1;exitX=0.7;exitY=0;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1">
                    <mxGeometry width="160" relative="1" as="geometry">
                        <mxPoint x="-5" y="2352" as="sourcePoint"/>
                        <mxPoint x="502.99999999999955" y="2352" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>